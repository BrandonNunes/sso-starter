import{av as Te,s as re,r,W as _e,j as h,Y as ve,a as t,_ as Ce,$ as Z,E as we,D as T,aa as De,B as _,ac as Re,b as xe,ah as v,aN as Ie,ai as Ne,L as Me,an as Ae,aD as Fe,ag as Le,f as Oe,i as Pe,g as Ee,aj as We,d as je,h as ze,aw as Ve,a7 as ae,a0 as de,M as $e,ax as qe,ay as Y,az as oe,ak as Be,aE as Ue,aF as He,aG as Ke}from"./index-7cffcf74.js";import{u as ue}from"./productsService-a4f11891.js";import{u as Ge}from"./storeService-325e002b.js";const Xe=Te`
  from {
    transform: translateX(100%);
  }

  to {
    transform: translateX(0%);
  }
`,Ye=re.div`
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  width: 100%;
  padding: 20px;
  gap: 20px;
  animation: ${Xe} 0.3s linear alternate;
`,Je=re.article`
  display: flex;
  align-items: center;
  gap: 16px;
`,Qe=re.form`
  display: flex;
  width: 100%;
  gap: 15px;
  flex-wrap: wrap;
  justify-content: flex-start;
  padding-top: 15px;
  flex-direction: column;
`,Ze=re.div`
  width: 100%;
  display: flex;
  justify-content: flex-end;
`;function et({open:m,toggleNewAtribut:N,atributs:b,catalogos:z,mascaras:O,tabelas:L,guid:C,refreshList:V}){const E=r.useRef(null),w=r.useRef(null),[$,u]=r.useState(!1),{createAttributService:D}=ue(),{register:P,handleSubmit:W,formState:{errors:x},reset:R,control:g,setValue:J,watch:k,resetField:y}=_e({defaultValues:{id:0,ativo:!0,obrigatorio:!0,mascara:null}}),f=(s,c,i="",S=4e3)=>{w.current!=null&&w.current.show({severity:s,summary:c,detail:i,life:S,contentStyle:{display:"flex",gap:"20px"}})},I=()=>{R(),N()},q=async s=>{u(!0),D(s,C).then(c=>{let i=c.data[0].msg;if(c.data[0].erro==="true"){f("warn","Falha",`${i||""}`);return}f("success","Sucesso",`${i||""}`),setTimeout(()=>I(),1e3),V()}).catch(c=>{console.error(c),f("error","Falha ao Cadastrar",`${c.response.data.msg}`,1e4)}).finally(()=>u(!1))},j=k("tipo_campo");return h(ve,{header:"Adicionar Novo Atributo",visible:m,style:{minWidth:"40%"},onHide:I,children:[t(Ce,{ref:w,position:"top-right"}),h(Qe,{onSubmit:W(q),children:[t(Z,{name:"nome_campo",control:g,rules:{required:!0},render:({field:s,fieldState:c})=>{var i;return h("span",{className:"p-float-label",style:{flex:1,minWidth:"200px"},children:[t(we,{id:"nome_campo",style:{width:"100%"},...P("nome_campo"),className:((i=x.nome_campo)==null?void 0:i.type)==="required"?"p-invalid":""}),t("label",{htmlFor:"nome_campo",children:"Nome do Atributo"})]})}}),t(Z,{name:"tipo_campo",control:g,rules:{required:!0},render:({field:s,fieldState:c})=>{var i;return h("span",{className:"p-float-label",style:{flex:1,fontSize:"12px",minWidth:"120px"},children:[t(T,{value:s.value,optionLabel:"descricao",optionValue:"id",placeholder:"Tipo",options:b,onChange:S=>s.onChange(Number(S.value)),className:((i=x.tipo_campo)==null?void 0:i.type)==="required"?"p-invalid":"",style:{fontSize:"12px",height:"38px",width:"100%"}}),t("label",{htmlFor:"tipo_campo",children:"Tipo do Campo"})]})}}),j===1&&t(Z,{name:"origem_tipo",control:g,rules:{required:!1},render:({field:s,fieldState:c})=>{var i;return h("span",{className:"p-float-label",style:{flex:1,fontSize:"12px",minWidth:"120px"},children:[t(T,{value:s.value,optionLabel:"descricao",optionValue:"sigla",placeholder:"Catálogos",options:z,onChange:S=>s.onChange(S.value),className:((i=x.origem_tipo)==null?void 0:i.type)==="required"?"p-invalid":"",style:{fontSize:"12px",height:"38px",width:"100%"}}),t("label",{htmlFor:"origem_tipo",children:"Origem dos Dados "})]})}}),j===2&&t(Z,{name:"origem_tipo",control:g,rules:{required:!1},render:({field:s,fieldState:c})=>{var i;return h("span",{className:"p-float-label",style:{flex:1,fontSize:"12px",minWidth:"120px"},children:[t(T,{value:s.value,optionLabel:"descricao",optionValue:"id",placeholder:"Tabelas",options:L,onChange:S=>s.onChange(Number(S.value)),className:((i=x.origem_tipo)==null?void 0:i.type)==="required"?"p-invalid":"",style:{fontSize:"12px",height:"38px",width:"100%"}}),t("label",{htmlFor:"origem_tipo",children:"Origem dos Dados "})]})}}),t(Z,{name:"mascara",control:g,rules:{required:!1},render:({field:s,fieldState:c})=>{var i;return h("span",{className:"p-float-label",style:{flex:1,fontSize:"12px",minWidth:"120px"},children:[t(T,{value:s.value,optionLabel:"descricao",optionValue:"id",placeholder:"Máscara",options:O,onChange:S=>s.onChange(Number(S.value)),className:((i=x.mascara)==null?void 0:i.type)==="required"?"p-invalid":"",style:{fontSize:"12px",height:"38px",width:"100%"}}),t("label",{htmlFor:"mascara",children:"Máscara "})]})}}),t(Z,{name:"obrigatorio",control:g,rules:{required:!1},render:({field:s,fieldState:c})=>h("span",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[t("label",{htmlFor:s.name,children:"Obrigatório"}),t(De,{inputId:s.name,checked:s.value,inputRef:s.ref,onChange:i=>s.onChange(i.value)})]})}),h(Ze,{children:[t(_,{label:"Cancelar",type:"button",className:"p-button-link",style:{gap:"10px",height:"35px",fontSize:"10px"},onClick:N}),t(_,{label:"Salvar",ref:E,loading:$,icon:"pi pi-check",className:"p-button-danger save-btn-form",iconPos:"left",style:{gap:"10px",height:"35px",fontSize:"10px"},type:"submit",onClick:()=>console.log(x)})]})]})]})}function tt({openAtributs:m,toggleAtributs:N,product:b}){const[z,O]=r.useState(!1),[L,C]=r.useState(!1),[V,E]=r.useState(!1),[w,$]=r.useState([]),[u,D]=r.useState([]),[P,W]=r.useState([]),[x,R]=r.useState([]),[g,J]=r.useState([]),{getTypeAttributListService:k,getAttributListByProductService:y,updateAttributService:f,deleteAtributService:I}=ue(),{getListAllCatalogosService:q}=Re(),{tokenSignature:j,storeUser:s}=xe(e=>e),c=r.useRef(null),i=()=>E(e=>!e),S=()=>N(),M=(e,o,a="",d=4e3)=>{c.current!=null&&c.current.show({severity:e,summary:o,detail:a,life:d,contentStyle:{display:"flex",gap:"20px"}})},ie=e=>{if(w!==void 0){const o=w.filter(a=>(a==null?void 0:a.id)===e.tipo_campo)[0].descricao;return t("div",{children:o})}},pe=e=>{if(P!==void 0&&e.mascara){const o=P.filter(a=>(a==null?void 0:a.id)===Number(e.mascara))[0].descricao;return t("div",{children:o})}return""},he=e=>{var a,d;const o=e.tipo_campo;if(o===1&&u!==void 0&&e.origem_tipo){const n=((a=u.filter(X=>(X==null?void 0:X.sigla)===e.origem_tipo)[0])==null?void 0:a.descricao)||"";return t("div",{children:n})}if(o===2&&g!==void 0&&e.origem_tipo){const n=((d=g.filter(X=>(X==null?void 0:X.id)===Number(e.origem_tipo))[0])==null?void 0:d.descricao)||"";return t("div",{children:n})}return""},Q=e=>{const o=[{name:"Ativo",value:!0},{name:"Inativo",value:!1}];return t(T,{optionLabel:"name",optionValue:"value",value:e.value,options:o,onChange:a=>e.editorCallback(a.value),placeholder:""})},le=e=>t(we,{type:"text",value:e.value,onChange:o=>e.editorCallback(o.target.value)}),[se,ne]=r.useState(0),me=e=>{const o=e.field;e.rowIndex;const a=e.rowData.tipo_campo;ne(a);const d=n=>{if(n==="mascara")return P;if(n==="tipo_campo")return w;if(n==="origem_tipo")return u};return o==="origem_tipo"&&e.rowData.origem_tipo!==1?t("span",{style:{minWidth:"100px"},children:se===1?t(T,{optionLabel:"descricao",optionValue:"sigla",value:e.value,options:d(o),style:{width:"100%",height:"45px"},onChange:n=>e.editorCallback(n.value),placeholder:"Selecionar opção"}):se===2?t(T,{optionLabel:"descricao",optionValue:"id",value:e.value,options:g,style:{width:"100%",height:"45px"},onChange:n=>e.editorCallback(n.value),placeholder:"Selecionar opção"}):""}):o==="tipo_campo"?t("span",{style:{minWidth:"100px"},children:t(T,{optionLabel:"descricao",optionValue:"id",value:e.value,options:d(o),style:{width:"100%",height:"45px"},onChange:n=>{e.editorCallback(n.value),ne(n.value)},placeholder:"Selecionar opção"})}):o==="mascara"&&(a===1||a===2)?"":t("span",{style:{minWidth:"100px"},children:t(T,{optionLabel:"descricao",optionValue:"id",value:e.value,options:d(o),style:{width:"100%",height:"45px"},onChange:n=>{e.editorCallback(n.value)},placeholder:"Selecionar opção"})})},B=e=>e.field==="descricao"?le(e):e.field==="obrigatorio"?Q(e):e.field==="nome_campo"?le(e):me(e),ce=(e,o)=>{C(!0),f(e,b.guid,o).then(a=>{let d=a.data[0].msg,n=a.data[0].erro||a.data.erro;if(n&&n=="true"){M("error","Falha",`${d||"Erro ao cadastrar"}`,1e4);return}n&&n=="false"&&M("success","Sucesso",`${d||"Processado realizado com sucesso"}`),K()}).catch(a=>{console.error(a),M("error","Falha ao Cadastrar",`${a.response.msg}`,1e4)}).finally(()=>C(!1))},ge=e=>{let o=[...x],{newData:a,index:d}=e;o[d]=a,R(o),ce(o[d])},ee=e=>{e.value.forEach((a,d)=>{ce(a,d+1)}),R(e.value)},U=e=>{let{rowData:o,newValue:a,field:d,originalEvent:n}=e;d==="obrigatorio"&&(o[d]=a),a.trim().length>0?o[d]=a:n.preventDefault()},fe=async e=>{C(!0),I([{sequencial:e.id}]).then(o=>{console.log(o);let a=o.data[0].msg;if(o.data[0].erro=="true"){M("error","Falha na execução",`${a}`,1e4);return}M("success","Sucesso",`${a||""}`),K()}).catch(o=>{console.error(o),M("error","Falha na execução",`${o.response.data.msg}`,1e4)}).finally(()=>C(!1))},be=e=>{Fe({message:"Você está certo que deseja apagar este item?",header:"Confirmar",icon:"pi pi-exclamation-triangle",rejectLabel:"Cancelar",acceptLabel:"Sim",acceptClassName:"red",accept:()=>fe(e),reject:()=>null})},Se=[{field:"id",header:"Código"},{field:"nome_campo",header:"Nome do Campo"},{field:"tipo_campo",header:"Tipo do Campo"},{field:"origem_tipo",header:"Origem"},{field:"mascara",header:"Máscara"},{field:"obrigatorio",header:"Obrigatório"}],ye=e=>t("div",{children:e.obrigatorio?"SIM":"NÃO"}),H=Se.map((e,o)=>e.field==="obrigatorio"?t(v,{columnKey:e.field,field:e.field,header:e.header,body:ye,editor:a=>B(a),onCellEditComplete:U},e.field):e.field==="tipo_campo"?t(v,{columnKey:e.field,field:e.field,header:e.header,body:ie,editor:a=>B(a),onCellEditComplete:U},e.field):e.field==="mascara"?t(v,{columnKey:e.field,field:e.field,header:e.header,body:pe,editor:a=>B(a),onCellEditComplete:U},e.field):e.field==="origem_tipo"?t(v,{columnKey:e.field,field:e.field,header:e.header,body:he,editor:a=>B(a),onCellEditComplete:U},e.field):e.field==="id"?t(v,{columnKey:e.field,field:e.field,header:e.header},e.field):t(v,{columnKey:e.field,field:e.field,header:e.header,editor:a=>B(a),onCellEditComplete:U},e.field)),l=()=>t(Me.Fragment,{children:t(_,{label:"Novo",icon:"pi pi-plus",className:"p-button-success mr-2",onClick:i,style:{display:"flex",gap:"10px"}})}),p=e=>h("div",{style:{display:"flex",gap:"5px"},children:[t(Ae,{visible:z,onHide:()=>O(!1),message:"Are you sure you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle"}),t(_,{icon:"pi pi-trash",className:"p-button-rounded p-button-text",style:{color:"#333"},"aria-label":"delete",title:"Apagar item",onClick:()=>be(e)})]}),A=()=>t("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end"},children:t(_,{label:"Fechar",icon:"pi pi-times",iconPos:"left",severity:"danger",onClick:N,style:{display:"flex",gap:"10px"}})}),K=()=>{C(!0),y(b.guid).then(e=>{R(e.data)}).catch(e=>console.warn(e)).finally(()=>C(!1))},F=()=>{k("atributo").then(e=>{$(e.data)}).catch(e=>console.warn(e))},G=()=>{k("mascara").then(e=>{W(e.data)}).catch(e=>console.warn(e))},te=()=>{k("tabela").then(e=>{J(e.data)}).catch(e=>console.warn(e))},ke=()=>{q().then(e=>{D(e.data)}).catch(e=>console.warn(e))};return r.useEffect(()=>{j&&(w.length||(F(),ke(),G(),te()),b&&m&&K())},[m,j]),h(ve,{visible:m,header:"Atributos",onHide:S,footer:A,style:{minHeight:"50vh",minWidth:"70vw"},breakpoints:{"960px":"75vw","820px":"100vw"},maximizable:!0,children:[t(Ce,{ref:c}),t(et,{open:V,toggleNewAtribut:i,atributs:w,catalogos:u,mascaras:P,guid:b&&b.guid||"",refreshList:K,tabelas:g}),b&&"Atributos do Produto: "+b.produto+" - "+b.descricao,t(Ie,{className:"mb-4",left:l}),h(Ne,{value:x,loading:L,editMode:"row",reorderableColumns:!0,reorderableRows:!0,onRowReorder:ee,emptyMessage:"Sem dados a exibir",onRowEditComplete:ge,children:[t(v,{rowReorder:!0,style:{width:"3em"}}),H,t(v,{header:"Ações",rowEditor:!0,headerStyle:{width:"10%",minWidth:"8rem"},bodyStyle:{textAlign:"center"},colSpan:2}),t(v,{body:p,style:{width:"2em"},rowEditor:!0})]})]})}function at({visible:m,listProductsSelecteds:N,toggleOpen:b}){const{colors:z}=r.useContext(Le),[O,L]=r.useState(!1),[C,V]=r.useState([]),[E,w]=r.useState(0);Ge();const{getAllStoresByUserService:$}=Oe(),{openNotification:u}=Pe(),{duplicateProductsService:D,getAttributListByProductService:P}=ue(),{tokenSignature:W,storeUser:x}=xe(),{getDataUser:R}=Ee(),g=()=>{b()},J=()=>{var y;L(!0),$((y=R())==null?void 0:y.guid).then(f=>{const I=f.data.filter(q=>q.loja!==Number(x));V(I)}).catch(f=>{console.error(f),u("warn","Falha ao obter lista de lojas disponíveis")}).finally(()=>L(!1))},k=()=>{L(!0),D(N,E).then(y=>{let f=y.data[0].msg;if(y.data[0].erro==="true"){u("warn","Falha",`${f||""}`);return}u("success","Sucesso",`${f||""}`),setTimeout(()=>g(),1e3)}).catch(y=>{console.error(y),u("error","Falha ao Cadastrar",`${y.response.data.msg}`,1e4)}).finally(()=>L(!1))};return r.useEffect(()=>{W&&J()},[N,W,x]),t(ve,{visible:m,header:"Duplicar para qual filial ?",onHide:g,style:{minHeight:"200px",minWidth:"200px",width:"30vw"},children:O?t(We,{mode:"indeterminate",style:{height:"6px"}}):h(ot,{children:[t(T,{value:E,onChange:y=>w(y.value),options:C,optionLabel:"razao_social",optionValue:"loja",placeholder:"Selecione uma loja",style:{width:"100%"}}),t(_,{onClick:k,disabled:!E,label:"Duplicar",style:{gap:"10px",fontSize:"10px",backgroundColor:z.primary}})]})})}const ot=re.div`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 15px;
`;function st(){const{colors:m}=r.useContext(Le),[N,b]=r.useState(),[z,O]=r.useState(""),[L,C]=r.useState(!1),[V,E]=r.useState(10),[w,$]=r.useState([]),[u,D]=r.useState([]),[P,W]=r.useState(null),[x,R]=r.useState(!1),[g,J]=r.useState(!1),{formProdutos:k,setRefreshListProducts:y}=je(l=>l),f=r.useRef(null),{getListAllProductsService:I,deleteProductsService:q}=ue(),{tokenSignature:j,storeUser:s}=xe(l=>l),{havePermission:c}=ze(),{openNotification:i}=Pe(),S=l=>{const p=l.target.value;let A={...N};A.global.value=p,b(A),O(p)},M=()=>{R(l=>!l)},ie=()=>{J(l=>!l)},pe=()=>{b({global:{value:null,matchMode:Y.CONTAINS},nome:{operator:oe.AND,constraints:[{value:null,matchMode:Y.STARTS_WITH}]},codigo:{operator:oe.AND,constraints:[{value:null,matchMode:Y.STARTS_WITH}]},cargo:{value:null,matchMode:Y.IN},status:{operator:oe.AND,constraints:[{value:null,matchMode:Y.STARTS_WITH}]},cadastro:{operator:oe.AND,constraints:[{value:null,matchMode:Y.CONTAINS}]},codigoEAN:{operator:oe.AND,constraints:[{value:null,matchMode:Y.CONTAINS}]}}),O("")},he=()=>{Fe({message:`Você está certo que deseja apagar o${u.length>1?"s":""} registro${u.length>1?"s":""} selecionado${u.length>1?"s":""}?`,header:"Confirmar",icon:"pi pi-exclamation-triangle",rejectLabel:"Cancelar",acceptLabel:"Sim",acceptClassName:"red",accept:()=>ge(),reject:()=>null})},Q=()=>{C(!0),I().then(l=>$(l.data)).catch(l=>{console.error(l),i("warn","Falha ao obter lista de produtos disponíveis")}).finally(()=>C(!1))},{listModuleFilters:le,operatorsFilters:se,createFilter:ne,loading:me,clearFilter:B,haveApplyFilters:ce}=Ve({module:ae.PRODUTO,refreshList:Q}),ge=()=>{const l=u.map(p=>({sequencial:p.Id}));q(l).then(p=>{let A=p.data[0].msg;if(p.data[0].erro==="true"){i("warn","Falha",`${A||""}`);return}i("success","Sucesso",`${A||""}`),D([]),Q();const F=document.getElementsByTagName("input");for(let G of F)G.checked=!1}).catch(p=>{console.error(p),i("error","Falha na execução",`${p.response.data.msg}`)})};r.useEffect(()=>{setTimeout(()=>{j&&Q()},500),y(Q)},[j,s]),r.useEffect(()=>{pe()},[]);const ee=r.useRef(null);let U=[{label:"Opções",items:[{label:"Visualizar",icon:"pi pi-fw pi-eye",command:l=>k(P)},{label:"Atributos do Produto",icon:"pi pi-file-edit",command:l=>M(),disabled:!c(ae.PRODUTO,de.ALTERAR)}]}];const fe=(l,p)=>{const A=p.target.checked;let K=l.Id,F=u;if(A){F==null||F.push(l);let G=F.filter(te=>te.Id!=0);D(G)}else{let G=F==null?void 0:F.filter(te=>te.Id!=K);D(G)}},be=l=>t("div",{style:{textAlign:"right"},children:Be(l.venda_padrao)}),ye=(()=>h(Ue,{children:[t(He,{listModuleFilters:le,operatorsFilters:se,setFilters:ne,loading:me,clearFilter:B,haveApplyFilters:ce}),h("span",{className:"p-input-icon-left",style:{height:"30px"},children:[t("i",{className:"pi pi-search"}),t(Ke,{value:z,onChange:S,placeholder:"Buscar"})]})]}))(),H={headerStyle:{fontSize:"14px",fontWeight:"bold",backgroundColor:m.backgroundColor,color:m.textColor},bodyStyle:{fontSize:"12px",fontWeight:600,backgroundColor:m.backgroundColor,color:m.textColor}};return h(Ye,{children:[t(at,{visible:g,toggleOpen:ie,listProductsSelecteds:u}),t(Ae,{}),t(tt,{openAtributs:x,toggleAtributs:M,product:P}),h(Je,{children:[t(_,{label:"Novo Produto",icon:"pi pi-plus-circle",iconPos:"left",className:"p-button-danger new-btn",disabled:!c(ae.PRODUTO,de.INCLUIR),onClick:()=>k()}),t(_,{label:"Excluir",className:"p-button-danger",icon:"pi pi-trash",iconPos:"left",onClick:()=>he(),disabled:!u.length||!c(ae.PRODUTO,de.EXCLUIR),style:{gap:"10px",borderColor:"#c1c1c1",fontSize:"12px",backgroundColor:"var(--color-in-menu)"}}),t(_,{label:"Duplicar em Outra Filial",icon:"pi pi-copy",iconPos:"left",className:"p-button-danger",disabled:!u.length||!c(ae.PRODUTO,de.INCLUIR),style:{gap:"10px",fontSize:"12px",backgroundColor:m.primary},onClick:()=>ie()})]}),t($e,{model:U,popup:!0,ref:ee}),h(Ne,{value:w,className:"p-datatable-customers",showGridlines:!0,dataKey:"produto",filters:N,filterDisplay:"menu",loading:L,globalFilterFields:["nome","status","produto","codigo","cargo","cadastro","codigoEAN","venda_padrao"],header:ye,emptyMessage:"Nenhum dado encontrado.",paginator:!0,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} / {last} de {totalRecords}",rows:V,rowsPerPageOptions:[10,20,50],scrollable:!0,scrollHeight:"58vh",removableSort:!0,children:[t(v,{headerClassName:"header-table",headerStyle:{width:"2em",backgroundColor:m.backgroundColor,color:m.textColor},bodyStyle:{backgroundColor:m.backgroundColor,color:m.textColor},body:l=>t("input",{ref:f,type:"checkbox",onChange:p=>fe(l,p)})}),t(v,{field:"produto",header:"Cód. Produto",style:{minWidth:"2rem"},headerClassName:"header-table",...H,sortable:!0}),t(v,{field:"descricao",header:"Descrição",style:{maxWidth:"12rem"},headerClassName:"header-table",...H,sortable:!0}),t(v,{field:"venda_padrao",header:"Valor",showFilterMatchModes:!1,style:{maxWidth:"12rem"},headerClassName:"header-table",...H,body:be,sortable:!0}),t(v,{field:"situacao",header:"Situação",body:l=>t(qe,{value:l.situacao}),headerClassName:"header-table",filterMenuStyle:{width:"14rem"},style:{width:"3rem"},...H,sortable:!0}),t(v,{header:"Ações",headerClassName:"header-table",body:l=>t(_,{label:"",icon:"pi pi-ellipsis-v",className:"p-button-text",style:{padding:0},onClick:p=>{ee.current!=null&&ee.current.toggle(p),W(l)}}),style:{width:"1rem"},...H})]})]})}export{st as default};
