import{av as oe,s as A,r as o,d as re,ag as se,b as le,h as ne,aw as ie,a7 as T,j as u,a,_ as ce,an as de,B as x,a0 as P,M as ue,ai as pe,ah as l,ax as he,aD as me,ay as p,az as y,aM as ge,aE as fe,aF as be,aG as Ce}from"./index-7cffcf74.js";import{u as Se}from"./transportadorService-0d67e348.js";const Te=oe`
  from {
    transform: translateX(100%);
  }

  to {
    transform: translateX(0%);
  }
`,xe=A.div`
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  width: 100%;
  padding: 20px;
  gap: 20px;
  animation: ${Te} 0.3s linear alternate;
`,ye=A.article`
  display: flex;
  align-items: center;
  gap: 16px;
`;function ke(){const[N,v]=o.useState(),[L,w]=o.useState(""),[D,F]=o.useState(!1),[I,Ne]=o.useState(10),[j,O]=o.useState([]),[c,g]=o.useState([]),[z,E]=o.useState(null),{formTransportadores:k,setRefreshListTransportadores:W}=re(e=>e),{deleteTransportadoresService:_,getListAllTransportadoresService:H}=Se(),{colors:s}=o.useContext(se),{tokenSignature:R,storeUser:q}=le(e=>e),{havePermission:M}=ne(),f=o.useRef(null),h=(e,t,i="",d=4e3)=>{f.current!=null&&f.current.show({severity:e,summary:t,detail:i,life:d,contentStyle:{display:"flex",gap:"20px"}})},m=()=>{F(!0),H().then(e=>O(e.data)).catch(e=>{console.error(e),h("warn","Falha ao obter lista de transportadores disponíveis")}).finally(()=>F(!1))},{listModuleFilters:$,operatorsFilters:B,createFilter:G,loading:X,clearFilter:U,haveApplyFilters:V}=ie({module:T.TRANSPORTADOR,refreshList:m}),J=()=>{_(c).then(e=>{let t=e.data[0].msg;if(e.data[0].erro==="true"){h("warn","Falha",`${t||""}`);return}h("success","Sucesso",`${t||""}`),g([]),m();const d=document.getElementsByTagName("input");for(let r of d)r.checked=!1}).catch(e=>{console.error(e),h("error","Falha na execução",`${e.response.data.msg}`)})},K=()=>{me({message:`Você está certo que deseja apagar o${c.length>1?"s":""} registro${c.length>1?"s":""} selecionado${c.length>1?"s":""}?`,header:"Confirmar",icon:"pi pi-exclamation-triangle",rejectLabel:"Cancelar",acceptLabel:"Sim",acceptClassName:"red",accept:()=>J(),reject:()=>null})},Q=e=>{const t=e.target.value;let i={...N};i.global.value=t,v(i),w(t)},Y=(()=>u(fe,{children:[a(be,{listModuleFilters:$,operatorsFilters:B,setFilters:G,loading:X,clearFilter:U,haveApplyFilters:V}),u("span",{className:"p-input-icon-left",style:{height:"30px"},children:[a("i",{className:"pi pi-search"}),a(Ce,{value:L,onChange:Q,placeholder:"Buscar"})]})]}))(),Z=()=>{v({global:{value:null,matchMode:p.CONTAINS},razao_social:{operator:y.AND,constraints:[{value:null,matchMode:p.STARTS_WITH}]},codigo:{operator:y.AND,constraints:[{value:null,matchMode:p.STARTS_WITH}]},telefone:{value:null,matchMode:p.IN},status:{operator:y.AND,constraints:[{value:null,matchMode:p.STARTS_WITH}]}}),w("")};o.useEffect(()=>{Z()},[]),o.useEffect(()=>{setTimeout(()=>{R&&m()},500),W(m)},[R,q]);const ee=(e,t)=>{const i=t.target.checked;let d=e.sequencial,r=c;if(i){r==null||r.push({sequencial:d});let C=r.filter(S=>S.sequencial!=0);g(C)}else{let C=r==null?void 0:r.filter(S=>S.sequencial!=d);g(C)}},b=o.useRef(null);let ae=[{label:"Opções",items:[{label:"Visualizar",icon:"pi pi-fw pi-eye",command:e=>k(z)}]}];const te=e=>a("div",{children:ge(e.cnpj)}),n={headerStyle:{fontSize:"14px",fontWeight:"bold",backgroundColor:s.backgroundColor,color:s.textColor},bodyStyle:{fontSize:"12px",fontWeight:600,backgroundColor:s.backgroundColor,color:s.textColor}};return u(xe,{children:[a(ce,{ref:f,position:"top-right"}),a(de,{}),u(ye,{children:[a(x,{label:"Novo Transportador",icon:"pi pi-plus-circle",iconPos:"left",className:"p-button-danger new-btn",disabled:!M(T.TRANSPORTADOR,P.INCLUIR),onClick:()=>k()}),a(x,{label:"Excluir",className:"p-button-danger",icon:"pi pi-trash",iconPos:"left",onClick:()=>K(),disabled:!c.length||!M(T.TRANSPORTADOR,P.EXCLUIR),style:{gap:"10px",borderColor:"#c1c1c1",fontSize:"12px",backgroundColor:"var(--color-in-menu)"}})]}),a(ue,{model:ae,popup:!0,ref:b}),u(pe,{value:j,className:"p-datatable-customers",showGridlines:!0,dataKey:"id",filters:N,filterDisplay:"menu",loading:D,globalFilterFields:["razao_social","situacao","sequencial","cpf","contato"],header:Y,emptyMessage:"Nenhum dado encontrado.",paginator:!0,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} / {last} de {totalRecords}",rows:I,rowsPerPageOptions:[10,20,50],scrollable:!0,scrollHeight:"58vh",tableStyle:{width:"100%",overflowX:"auto"},removableSort:!0,children:[a(l,{headerClassName:"header-table",headerStyle:{width:"2em",backgroundColor:s.backgroundColor,color:s.textColor},bodyStyle:{backgroundColor:s.backgroundColor,color:s.textColor},body:e=>a("input",{type:"checkbox",onChange:t=>ee(e,t)})}),a(l,{field:"sequencial",header:"Código",style:{width:"2.5rem"},headerClassName:"header-table",...n,sortable:!0}),a(l,{field:"cnpj",header:"CNPJ",showFilterMatchModes:!1,style:{width:"9rem"},headerClassName:"header-table",...n,body:te}),a(l,{field:"razao_social",header:"Razão Social",showFilterMatchModes:!1,style:{maxWidth:"10rem",lineHeight:"unset"},headerClassName:"header-table",...n,sortable:!0}),a(l,{field:"nome_fantasia",header:"Nome Fantasia",bodyClassName:"text-center cell-table",style:{maxWidth:"8rem"},headerClassName:"header-table",...n,sortable:!0}),a(l,{field:"contato",header:"Contato",style:{maxWidth:"8rem"},headerClassName:"header-table",...n,sortable:!0}),a(l,{field:"situacao",header:"Situação",body:e=>a(he,{value:e.situacao}),filterMenuStyle:{width:"14rem"},style:{width:"3rem"},headerClassName:"header-table",...n,sortable:!0}),a(l,{header:"Ações",headerClassName:"header-table",body:e=>a(x,{label:"",icon:"pi pi-ellipsis-v",className:"p-button-text",onClick:t=>{b.current!=null&&b.current.toggle(t),E(e)}}),style:{width:"1rem"},...n})]})]})}export{ke as default};
