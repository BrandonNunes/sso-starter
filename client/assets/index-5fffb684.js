import{av as te,s as L,r as o,ag as ae,d as oe,b as re,h as se,i as le,aw as ne,j as i,a as t,an as ie,B as S,a7 as P,a0 as G,M as ce,ai as ue,ah as c,ax as de,ay as x,az as T,aD as pe,aE as he,aF as ge,aG as me}from"./index-7cffcf74.js";import{u as fe}from"./groupService-ac41a1ff.js";const be=te`
  from {
    transform: translateX(100%);
  }

  to {
    transform: translateX(0%);
  }
`,Ce=L.div`
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  width: 100%;
  padding: 20px;
  gap: 20px;
  animation: ${be} 0.3s linear alternate;
`,Se=L.article`
  display: flex;
  align-items: center;
  gap: 16px;
`;function Fe(){const{colors:s}=o.useContext(ae),[y,v]=o.useState(),[M,k]=o.useState(""),[R,g]=o.useState(!1),[D,xe]=o.useState(10),[A,I]=o.useState([]),[l,m]=o.useState([]),[O,E]=o.useState(null),{formGrupos:F,setRefreshListGrupos:U}=oe(e=>e),{tokenSignature:N,storeUser:$}=re(e=>e),{deleteGroupService:j,getAllGroupService:H}=fe(),{havePermission:w}=se(),{openNotification:u}=le(),W=e=>{const a=e.target.value;let n={...y};n.global.value=a,v(n),k(a)},z=()=>{v({global:{value:null,matchMode:x.CONTAINS},grupo:{operator:T.AND,constraints:[{value:null,matchMode:x.STARTS_WITH}]},descricao:{operator:T.AND,constraints:[{value:null,matchMode:x.STARTS_WITH}]}}),k("")};o.useEffect(()=>{z()},[]);const B=(e,a)=>{const n=a.target.checked;let h=e.grupo,r=l;if(n){r==null||r.push({sequencial:+h});let b=r.filter(C=>C.sequencial!=0);m(b)}else{let b=r==null?void 0:r.filter(C=>C.sequencial!=+h);m(b)}},d=async()=>{g(!0),H().then(e=>{I(e.data),g(!1)}).catch(e=>{g(!1),console.error(e),u("warn","Falha ao obter lista de grupos disponíveis","")})},{listModuleFilters:_,operatorsFilters:q,createFilter:V,loading:X,clearFilter:K,haveApplyFilters:J}=ne({module:1030,refreshList:d}),Q=()=>{pe({message:`Você está certo que deseja apagar o${l.length>1?"s":""} registro${l.length>1?"s":""} selecionado${l.length>1?"s":""}?`,header:"Confirmar",icon:"pi pi-exclamation-triangle",rejectLabel:"Cancelar",acceptLabel:"Sim",acceptClassName:"red",accept:()=>Y(),reject:()=>null})},Y=async()=>{j(l).then(e=>{let a=e.data[0].msg;if(e.data[0].erro=="true"){u("error","Falha na execução",`${a}`,1e4);return}u("success","Sucesso",`${a||""}`),m([]),d();const h=document.getElementsByTagName("input");for(let r of h)r.checked=!1}).catch(e=>{console.error(e),u("error","Falha na execução",`${e.response.data.msg}`,1e4)})};o.useEffect(()=>{setTimeout(()=>{N&&d()},500),U(d)},[N,$]);const f=o.useRef(null);let Z=[{label:"Opções",items:[{label:"Visualizar",icon:"pi pi-fw pi-eye",command:e=>F(O)}]}];const ee=(()=>i(he,{children:[t(ge,{listModuleFilters:_,operatorsFilters:q,setFilters:V,loading:X,clearFilter:K,haveApplyFilters:J}),i("span",{className:"p-input-icon-left",style:{height:"30px"},children:[t("i",{className:"pi pi-search"}),t(me,{value:M,onChange:W,placeholder:"Buscar"})]})]}))(),p={headerStyle:{fontSize:"14px",fontWeight:"bold",backgroundColor:s.backgroundColor,color:s.textColor},bodyStyle:{fontSize:"12px",fontWeight:600,backgroundColor:s.backgroundColor,color:s.textColor}};return i(Ce,{children:[t(ie,{}),i(Se,{children:[t(S,{label:"Novo Grupo de Produto",icon:"pi pi-plus-circle",iconPos:"left",className:"p-button-danger new-btn",disabled:!w(P.GRUPO_PRODUTO,G.INCLUIR),onClick:()=>F()}),t(S,{label:"Excluir",className:"p-button-danger",icon:"pi pi-trash",iconPos:"left",disabled:!l.length||!w(P.GRUPO_PRODUTO,G.EXCLUIR),onClick:()=>Q(),style:{gap:"10px",borderColor:"#c1c1c1",fontSize:"12px",backgroundColor:"var(--color-in-menu)"}})]}),t(ce,{model:Z,popup:!0,ref:f}),i(ue,{value:A,className:"p-datatable-customers",showGridlines:!0,dataKey:"id",filters:y,filterDisplay:"menu",loading:R,globalFilterFields:["grupo","descricao","ativo"],header:ee,emptyMessage:"Nenhum dado encontrado.",paginator:!0,responsiveLayout:"scroll",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} / {last} de {totalRecords}",rows:D,rowsPerPageOptions:[10,20,50],scrollable:!0,scrollHeight:"58vh",removableSort:!0,children:[t(c,{headerClassName:"header-table",headerStyle:{width:"2em",backgroundColor:s.backgroundColor,color:s.textColor},bodyStyle:{backgroundColor:s.backgroundColor,color:s.textColor},body:e=>t("input",{type:"checkbox",onChange:a=>B(e,a)})}),t(c,{field:"grupo",header:"Código",style:{width:"0.5rem"},headerClassName:"header-table",...p,sortable:!0}),t(c,{field:"descricao",header:"Descrição",showFilterMatchModes:!1,style:{maxWidth:"6rem"},headerClassName:"header-table",...p,sortable:!0}),t(c,{field:"ativo",header:"Situação",body:e=>t(de,{value:e.ativo}),style:{width:"2rem"},headerClassName:"header-table",...p,sortable:!0}),t(c,{header:"Ações",body:e=>t(S,{label:"",icon:"pi pi-ellipsis-v",className:"p-button-text",onClick:a=>{f.current!=null&&f.current.toggle(a),E(e)}}),style:{width:"1rem"},headerClassName:"header-table",...p})]})]})}export{Fe as default};
