import{b as ie,h as ne,r as l,ag as ce,d as de,f as ue,i as pe,aw as he,j as d,aK as fe,a as t,_ as me,an as be,aL as ge,B as b,a7 as T,a0 as U,M as Ce,ai as ye,ah as r,ax as Ne,aA as I,aD as ve,ay as u,az as g,aM as Se,D as Fe,aE as we,aF as Me,aG as ke}from"./index-7cffcf74.js";import{I as xe}from"./inputmask.esm-a0b42ab9.js";function Le(){const{tokenSignature:S}=ie(e=>e),{havePermission:F}=ne(),[L,P]=l.useState([]),[D,w]=l.useState(""),[O,M]=l.useState(!1),[j,Ae]=l.useState(10),[i,C]=l.useState([]),{colors:o}=l.useContext(ce),[R,B]=l.useState(null),{formUsuarios:k,setRefreshListUsers:E}=de(e=>e),{getAllUserService:_,deleteUsersService:V}=ue(),{openNotification:p}=pe(),[x,A]=l.useState(null),W=l.useRef(null),h=()=>{M(!0),_().then(e=>{e.data.map(a=>a.datacadastro?(a.datacadastro.split("T")[0],{...a,datacadastro:I(a.datacadastro.split("T")[0])}):{...a,datacadastro:""}),P(e.data)}).catch(e=>{console.error(e),p("warn","Falha ao obter lista de usuários disponíveis")}).finally(()=>M(!1))},{listModuleFilters:$,operatorsFilters:z,createFilter:q,loading:G,clearFilter:H,haveApplyFilters:K}=he({module:1005,refreshList:h}),X=()=>{V(i).then(e=>{let a=e.data[0].msg;if(e.data[0].erro==="true"){p("warn","Falha",`${a||""}`);return}p("success","Sucesso",`${a||""}`),C([]),h();const m=document.getElementsByTagName("input");for(let s of m)s.checked=!1}).catch(e=>{console.error(e),p("error","Falha na execução",`${e.response.data.msg}`)})},J=()=>{ve({message:`Você está certo que deseja apagar o${i.length>1?"s":""} registro${i.length>1?"s":""} selecionado${i.length>1?"s":""}?`,header:"Confirmar",icon:"pi pi-exclamation-triangle",rejectLabel:"Cancelar",acceptLabel:"Sim",acceptClassName:"red",accept:()=>X(),reject:()=>null})},Q=e=>{const a=e.target.value;let c={...x};c.global.value=a,A(c),w(a)},Y=(()=>d(we,{children:[t(Me,{listModuleFilters:$,operatorsFilters:z,setFilters:q,loading:G,clearFilter:H,haveApplyFilters:K}),d("span",{className:"p-input-icon-left",style:{height:"30px"},children:[t("i",{className:"pi pi-search"}),t(ke,{value:D,onChange:Q,placeholder:"Buscar"})]})]}))(),Z=()=>{A({global:{value:null,matchMode:u.CONTAINS},usuario:{operator:g.AND,constraints:[{value:null,matchMode:u.CONTAINS}]},ativo:{operator:g.AND,constraints:[{value:null,matchMode:u.CONTAINS}]},cpf_cnpj:{operator:g.AND,constraints:[{value:null,matchMode:u.CONTAINS}]},datacadastro:{operator:g.AND,constraints:[{value:null,matchMode:u.CONTAINS}]}}),w("")};l.useEffect(()=>{S&&(h(),E(h)),Z()},[S]);const ee=(e,a)=>{const c=a.target.checked;let m=e.id,s=i;if(c){s==null||s.push({sequencial:m});let N=s.filter(v=>v.sequencial!=0);C(N)}else{let N=s==null?void 0:s.filter(v=>v.sequencial!=m);C(N)}},y=l.useRef(null);let ae=[{label:"Opções",items:[{label:"Visualizar",icon:"pi pi-fw pi-eye",command:e=>k(R)}]}];const te=e=>e.cpf_cnpj?t("div",{children:Se(e.cpf_cnpj)}):"- - -",le=e=>{const a=e.datacadastro;return a?I(a.split("T")[0]):""},f=e=>t(b,{type:"button",label:"Aplicar",icon:"pi pi-check",onClick:e.filterApplyCallback,severity:"info",style:{display:"flex",gap:"5px"}}),se=[{label:"ATIVO",value:!0},{label:"INATIVO",value:!1}],oe=e=>t(Fe,{value:e.value,options:se,onChange:a=>e.filterCallback(a.value),optionLabel:"label",optionValue:"value",className:"p-column-filter"}),re=e=>t(xe,{mask:"99/99/9999",value:e.value,onChange:a=>{e.filterCallback(a.target.value),console.log(new Date(a.target.value).toISOString().split("T")[0])}}),n={headerStyle:{fontSize:"14px",fontWeight:"bold",backgroundColor:o.backgroundColor,color:o.textColor},bodyStyle:{fontSize:"12px",fontWeight:600,backgroundColor:o.backgroundColor,color:o.textColor}};return d(fe,{children:[t(me,{ref:W,position:"top-right"}),t(be,{}),d(ge,{children:[t(b,{label:"Novo Usuário",icon:"pi pi-plus-circle",iconPos:"left",className:"p-button-danger new-btn",disabled:!F(T.USUARIO,U.INCLUIR),onClick:()=>k()}),t(b,{label:"Excluir",className:"p-button-danger",icon:"pi pi-trash",iconPos:"left",onClick:()=>J(),disabled:!i.length||!F(T.USUARIO,U.EXCLUIR),style:{gap:"10px",borderColor:"#c1c1c1",fontSize:"12px",backgroundColor:"var(--color-in-menu)"}})]}),t(Ce,{model:ae,popup:!0,ref:y}),d(ye,{value:L,className:"p-datatable-customers",showGridlines:!0,dataKey:"id",filters:x,filterDisplay:"menu",loading:O,globalFilterFields:["usuario","ativo","id","cpf_cnpj","cadastro"],header:Y,emptyMessage:"Nenhum dado encontrado.",paginator:!0,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} / {last} de {totalRecords}",rows:j,rowsPerPageOptions:[10,20,50],scrollable:!0,scrollHeight:"60vh",removableSort:!0,children:[t(r,{headerClassName:"header-table",bodyClassName:"cell-table",headerStyle:{width:"2em",backgroundColor:o.backgroundColor,color:o.textColor},bodyStyle:{backgroundColor:o.backgroundColor,color:o.textColor,height:"20px"},body:e=>t("input",{type:"checkbox",onChange:a=>ee(e,a)})}),t(r,{sortable:!0,field:"id",header:"Código",style:{width:"2rem"},headerClassName:"header-table",bodyClassName:"cell-table",...n}),t(r,{sortable:!0,field:"usuario",header:"Nome",headerClassName:"header-table",bodyClassName:"cell-table",style:{maxWidth:"12rem"},...n,filterField:"usuario",filterApply:f,filterMatchMode:"contains",showFilterMatchModes:!1,showFilterOperator:!1,showAddButton:!1}),t(r,{field:"cpf_cnpj",header:"CPF",body:te,headerClassName:"header-table",bodyClassName:"text-center cell-table",style:{maxWidth:"8rem"},...n,filterField:"cpf_cnpj",filterApply:f,filterMatchMode:"contains",showFilterMatchModes:!1,showFilterOperator:!1,showAddButton:!1}),t(r,{sortable:!0,dataType:"date",field:"datacadastro",header:"Data Cadastro",headerClassName:"header-table",bodyClassName:"text-center cell-table",style:{minWidth:"5rem"},...n,body:le,filterField:"datacadastro",filterApply:f,filterMatchMode:"startsWith",showFilterMatchModes:!1,showFilterOperator:!1,showAddButton:!1,filterElement:re}),t(r,{sortable:!0,field:"ativo",header:"Situação",body:e=>t(Ne,{value:e.ativo}),headerClassName:"header-table",bodyClassName:"cell-table",style:{width:"3rem"},...n,filterField:"ativo",filterApply:f,filterMatchMode:"contains",showFilterMatchModes:!1,showFilterOperator:!1,showAddButton:!1,filterElement:oe}),t(r,{header:"Ações",headerClassName:"header-table",bodyClassName:"cell-table",body:e=>t(b,{label:"",icon:"pi pi-ellipsis-v",className:"p-button-text",style:{padding:0},onClick:a=>{y.current!=null&&y.current.toggle(a),B(e)}}),style:{width:"1rem"},...n})]})]})}export{Le as default};
