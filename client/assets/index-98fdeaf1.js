import{av as re,s as L,r as o,ag as se,d as le,b as ne,h as ie,aw as ce,a7 as x,j as h,a as t,_ as de,an as ue,B as y,a0 as R,M as he,ai as pe,ah as n,ax as me,aD as fe,ay as u,az as f,aM as ge,aX as be,aE as Ce,aF as Fe,aG as Se}from"./index-7cffcf74.js";import{u as xe}from"./fornecedorService-a740cee1.js";const ye=re`
  from {
    transform: translateX(100%);
  }

  to {
    transform: translateX(0%);
  }
`,Ne=L.div`
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  width: 100%;
  padding: 20px;
  gap: 20px;
  animation: ${ye} 0.3s linear alternate;
`,ve=L.article`
  display: flex;
  align-items: center;
  gap: 16px;
`;function Pe(){const[N,v]=o.useState(),[A,T]=o.useState(""),[D,k]=o.useState(!1),[E,Te]=o.useState(10),[I,j]=o.useState([]),[i,g]=o.useState([]),[O,W]=o.useState(null),{colors:s}=o.useContext(se),{formFornecedores:w,setRefreshListFornecedor:_}=le(e=>e),{tokenSignature:M,storeUser:H}=ne(e=>e),{getAllFornecedorService:$,deleteFornecedoresService:z}=xe(),{havePermission:P}=ie(),b=o.useRef(null),p=(e,a,l="",d=4e3)=>{b.current!=null&&b.current.show({severity:e,summary:a,detail:l,life:d,contentStyle:{display:"flex",gap:"20px"}})},m=()=>{k(!0),$().then(e=>{j(e.data)}).catch(e=>{console.error(e),p("warn","Falha ao obter lista de fornecedores disponíveis")}).finally(()=>k(!1))},{listModuleFilters:B,operatorsFilters:q,createFilter:G,loading:X,clearFilter:U,haveApplyFilters:V}=ce({module:x.FORNECEDOR,refreshList:m}),J=()=>{z(i).then(e=>{let a=e.data[0].msg;if(e.data[0].erro==="true"){p("warn","Falha",`${a||""}`);return}p("success","Sucesso",`${a||""}`),g([]),m();const d=document.getElementsByTagName("input");for(let r of d)r.checked=!1}).catch(e=>{console.error(e),p("error","Falha na execução",`${e.response.data.msg}`)})},K=()=>{fe({message:`Você está certo que deseja apagar o${i.length>1?"s":""} registro${i.length>1?"s":""} selecionado${i.length>1?"s":""}?`,header:"Confirmar",icon:"pi pi-exclamation-triangle",rejectLabel:"Cancelar",acceptLabel:"Sim",acceptClassName:"red",accept:()=>J(),reject:()=>null})},Q=e=>{const a=e.target.value;let l={...N};l.global.value=a,v(l),T(a)},Y=(()=>h(Ce,{children:[t(Fe,{listModuleFilters:B,operatorsFilters:q,setFilters:G,loading:X,clearFilter:U,haveApplyFilters:V}),h("span",{className:"p-input-icon-left",style:{height:"30px"},children:[t("i",{className:"pi pi-search"}),t(Se,{value:A,onChange:Q,placeholder:"Buscar"})]})]}))(),Z=()=>{v({global:{value:null,matchMode:u.CONTAINS},nome:{operator:f.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},codigo:{operator:f.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},cargo:{value:null,matchMode:u.IN},status:{operator:f.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},cadastro:{operator:f.AND,constraints:[{value:null,matchMode:u.CONTAINS}]}}),T("")};o.useEffect(()=>{Z(),M&&m(),_(m)},[M,H]);const ee=(e,a)=>{const l=a.target.checked;let d=e.fornecedor,r=i;if(l){r==null||r.push({sequencial:d});let F=r.filter(S=>S.sequencial!=0);g(F)}else{let F=r==null?void 0:r.filter(S=>S.sequencial!=d);g(F)}},te=e=>ge(e.cnpj),ae=e=>{let a=e.fone_ddd1+e.telefone1;return be(a)},C=o.useRef(null);let oe=[{label:"Opções",items:[{label:"Visualizar",icon:"pi pi-fw pi-eye",command:e=>w(O)}]}];const c={headerStyle:{fontSize:"14px",fontWeight:"bold",backgroundColor:s.backgroundColor,color:s.textColor},bodyStyle:{fontSize:"12px",fontWeight:600,backgroundColor:s.backgroundColor,color:s.textColor}};return h(Ne,{children:[t(de,{ref:b,position:"top-right"}),t(ue,{}),h(ve,{children:[t(y,{label:"Novo Fornecedor",icon:"pi pi-plus-circle",iconPos:"left",className:"p-button-danger new-btn",disabled:!P(x.FORNECEDOR,R.INCLUIR),onClick:()=>w()}),t(y,{label:"Excluir",className:"p-button-danger",icon:"pi pi-trash",iconPos:"left",onClick:()=>K(),disabled:!i.length||!P(x.FORNECEDOR,R.EXCLUIR),style:{gap:"10px",borderColor:"#c1c1c1",fontSize:"12px",backgroundColor:"var(--color-in-menu)"}})]}),t(he,{model:oe,popup:!0,ref:C}),h(pe,{value:I,className:"p-datatable-customers",showGridlines:!0,dataKey:"fornecedor",filters:N,filterDisplay:"menu",loading:D,globalFilterFields:["nome_fantasia","fornecedor","cnpj","situacao","telefone1"],header:Y,emptyMessage:"Nenhum dado encontrado.",paginator:!0,responsiveLayout:"scroll",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} / {last} de {totalRecords}",rows:E,rowsPerPageOptions:[10,20,50],scrollable:!0,scrollHeight:"58vh",removableSort:!0,children:[t(n,{headerClassName:"header-table",headerStyle:{width:"2em",backgroundColor:s.backgroundColor,color:s.textColor},bodyStyle:{backgroundColor:s.backgroundColor,color:s.textColor},body:e=>t("input",{type:"checkbox",onChange:a=>ee(e,a)})}),t(n,{field:"fornecedor",header:"Código",style:{minWidth:"2rem"},headerClassName:"header-table",...c,sortable:!0}),t(n,{field:"nome_fantasia",header:"Nome",showFilterMatchModes:!1,style:{maxWidth:"12rem"},headerClassName:"header-table",...c,sortable:!0}),t(n,{field:"cnpj",header:"CPF/CNPJ",body:te,style:{maxWidth:"12rem"},headerClassName:"header-table",...c}),t(n,{field:"telefone1",header:"Telefone",body:ae,style:{maxWidth:"8rem"},headerClassName:"header-table",...c,sortable:!0}),t(n,{field:"situacao",header:"Situação",body:e=>t(me,{value:e.situacao}),filterMenuStyle:{width:"14rem"},style:{width:"2rem"},headerClassName:"header-table",...c,sortable:!0}),t(n,{header:"Ações",body:e=>t(y,{label:"",icon:"pi pi-ellipsis-v",className:"p-button-text",onClick:a=>{C.current!=null&&C.current.toggle(a),W(e)}}),style:{width:"1rem"},headerClassName:"header-table",...c})]})]})}export{Pe as default};
